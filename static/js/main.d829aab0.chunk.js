(this["webpackJsonphacker-news-wrapper"]=this["webpackJsonphacker-news-wrapper"]||[]).push([[0],{43:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var c,s,r=n(1),a=n.n(r),i=n(22),o=(n(43),n(4)),l=n.n(o),j=n(7),d=n(14),u=n(3),b=n(18),h=n(80),O=Object(h.a)("STORIES_LATEST_ADD"),m=Object(h.a)("STORY_ADD"),x=Object(h.a)("LOADING_STATUS_CHANGE"),f=Object(h.a)("BRANCH_STATUS_SET"),p=Object(h.a)("BRANCH_STATUS_CHANGE"),v=n(8),k=[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115],S=n(25),N=n.n(S),y="https://hacker-news.firebaseio.com/v0/",w=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("".concat(y,"newstories.json?print=pretty")).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){return N.a.get("".concat(y,"item/").concat(e,".json?print=pretty")).then((function(e){return e.data})).catch((function(e){console.log(e)}))},B=n(0),E=function(){return Object(B.jsx)("article",{className:"story-preview",children:Object(B.jsxs)("div",{className:"skeleton-item",children:[Object(B.jsx)("div",{children:Object(B.jsx)("div",{className:"skeleton-block",style:{maxWidth:"500px"},children:" "})}),Object(B.jsxs)("div",{children:[Object(B.jsx)("div",{className:"skeleton-block",style:{maxWidth:"50px"},children:" "}),Object(B.jsx)("div",{className:"skeleton-block",style:{maxWidth:"100px"},children:" "}),Object(B.jsx)("div",{className:"skeleton-block",style:{maxWidth:"100px"},children:" "}),Object(B.jsx)("div",{className:"skeleton-block",style:{maxWidth:"100px"},children:" "})]})]})})},_=function(e){var t=6e4,n=36e5,c=864e5,s=2592e6,r=31536e6,a=new Date-new Date(1e3*e);return a<t?Math.round(a/1e3)+" seconds ago":a<n?Math.round(a/t)+" minutes ago":a<c?Math.round(a/n)+" hours ago":a<s?Math.round(a/c)+" days ago":a<r?Math.round(a/s)+" months ago":Math.round(a/r)+" years ago"},D=function(e){var t=e.id,n=Object(r.useState)({}),c=Object(v.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)("fetching"),o=Object(v.a)(i,2),d=o[0],u=o[1];return Object(r.useEffect)((function(){u("fetching"),function(){var e=Object(j.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then((function(){return u("finished")}))}),[t]),s&&"fetching"!==d?Object(B.jsxs)("article",{className:"story-preview",children:[Object(B.jsx)(b.b,{className:"link",to:"/".concat(s.id),children:s.title}),Object(B.jsxs)("section",{className:"story-info",children:[Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"Score:"})," ",s.score]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"By:"})," ",s.by]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"Posted:"})," ",_(s.time)]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"Comments:"})," ",s.descendants]})]})]}):Object(B.jsx)(E,{})},T=n(19),I=n.n(T),A={addLatestStories:O},R=Object(d.b)((function(e){return{stories:e.stories,ui:e.ui}}),A)((function(e){var t=e.stories,n=e.addLatestStories,c=Object(r.useState)(59),s=Object(v.a)(c,2),a=s[0],i=s[1];Object(r.useEffect)((function(){var e;return a>0?e=setTimeout((function(){return i(a-1)}),1e3):o().then((function(){return i(59)})),function(){clearTimeout(e)}}),[i,a]);var o=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,n({latestStoriesIDs:t.slice(0,100)}),i(59);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(B.jsxs)("main",{children:[Object(B.jsx)("h2",{children:"LATEST STORIES"}),Object(B.jsx)("div",{className:"refresh-btn-wrapper",children:Object(B.jsx)("button",{className:"button button-animated",onClick:o,children:Object(B.jsx)("span",{children:Object(B.jsxs)("span",{children:["Refresh ",a]})})})}),Object(B.jsx)("section",{className:"stories-list",children:0===t.latestStoriesIDs.length?k.map((function(e){return Object(B.jsx)("div",{className:"lazyload-wrapper",children:Object(B.jsx)(E,{})},e)})):t.latestStoriesIDs.map((function(e){return Object(B.jsx)(I.a,{placeholder:Object(B.jsx)(E,{}),offset:300,children:Object(B.jsx)(D,{id:e},e)},e)}))})]})})),C=n(12),W=n(13),L={changeBranchStatus:p},H=Object(d.b)((function(e){return{ui:e.ui}}),L)((function e(t){var n=t.commentID,c=t.changeBranchStatus,s=t.ui,a=Object(r.useState)([]),i=Object(v.a)(a,2),o=i[0],d=i[1],u=Object(r.useState)({}),b=Object(v.a)(u,2),h=b[0],O=b[1],m=Object(r.useState)("finished"),x=Object(v.a)(m,2),f=x[0],p=x[1];Object(r.useEffect)((function(){(function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p("fetching"),e.next=3,g(n);case 3:if(t=e.sent,O(t),t&&t.kids&&s.commentBranch[t.id]&&"closed"!==s.commentBranch[t.id]){e.next=7;break}return e.abrupt("return");case 7:d(t.kids);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){return p("finished")}))}),[n,s]);var k=!s.commentBranch[h.id]||"closed"===s.commentBranch[h.id],S="fetching"===f;return h&&Object(B.jsxs)("article",{className:"comment",children:[Object(B.jsx)("div",{className:"comment-info",children:h.by?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("span",{children:"By: "}),h.by,Object(B.jsx)("span",{children:" Posted: "}),_(h.time)]}):Object(B.jsx)("div",{className:"skeleton-block skeleton-block-header",style:{maxWidth:"300px"},children:" "})}),h.deleted?Object(B.jsx)("h4",{children:"[commentary deleted]"}):h.text?Object(B.jsx)("div",{className:"comment-text",dangerouslySetInnerHTML:{__html:h.text}}):Object(B.jsxs)("div",{className:"comment-text",children:[Object(B.jsx)("div",{className:"skeleton-block",children:" "}),Object(B.jsx)("div",{className:"skeleton-block",children:" "}),Object(B.jsx)("div",{className:"skeleton-block",children:" "})]}),h.kids?Object(B.jsx)("button",{className:"button button-animated button-comment",onClick:function(){var e=s.commentBranch[h.id]&&"closed"!==s.commentBranch[h.id]?"closed":"opened";sessionStorage.setItem("branchesStatus",JSON.stringify(Object(W.a)(Object(W.a)({},s.commentBranch),{},Object(C.a)({},h.id,e)))),c({id:h.id,status:e})},disabled:S,children:Object(B.jsx)("span",{children:Object(B.jsx)("span",{children:k?"Show replies":"Hide replies"})})}):Object(B.jsx)("button",{className:"button btn-disabled",disabled:!0,children:"expand replies"}),function(){if(0!==h.kids&&0!==o.length&&s)return s.commentBranch[h.id]&&"opened"===s.commentBranch[h.id]?o.map((function(t){return Object(B.jsx)(I.a,{children:Object(B.jsx)(e,{commentID:t,changeBranchStatus:c,ui:s},t)},t)})):void 0}()]})})),M=function(e){var t,n=e.match.params.id,c=Object(r.useState)({}),s=Object(v.a)(c,2),a=s[0],i=s[1],o=Object(r.useState)([]),d=Object(v.a)(o,2),u=d[0],b=d[1],h=Object(r.useState)(59),O=Object(v.a)(h,2),m=O[0],x=O[1];Object(r.useEffect)((function(){var e;return m>0?e=setTimeout((function(){return x(m-1)}),1e3):f().then((function(){return x(59)})),function(){clearTimeout(e)}}),[x,m]),Object(r.useEffect)((function(){(function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(n);case 2:(t=e.sent).kids&&b(t.kids),i(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){}))}),[n,b]);var f=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(n);case 2:(t=e.sent).kids&&b(t.kids),i(t),x(59);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a&&Object(B.jsx)("main",{children:Object(B.jsxs)("article",{children:[a.title?Object(B.jsxs)("h2",{children:[a.title," (",Object(B.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"nav-link link-source",href:a.url,children:"SOURCE"}),")"]}):Object(B.jsx)("div",{className:"skeleton-item justify-center",children:Object(B.jsx)("div",{className:"skeleton-block skeleton-block-title",style:{maxWidth:"500px"},children:" "})}),a.by?Object(B.jsxs)("section",{className:"story-info justify-center",children:[Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"Score:"})," ",a.score]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"By:"})," ",a.by]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{children:"Posted:"})," ",_(a.time)]})]}):Object(B.jsxs)("div",{className:"skeleton-item justify-center",children:[Object(B.jsx)("div",{className:"skeleton-block skeleton-block-info",style:{maxWidth:"50px"},children:" "}),Object(B.jsx)("div",{className:"skeleton-block skeleton-block-info",style:{maxWidth:"100px"},children:" "}),Object(B.jsx)("div",{className:"skeleton-block skeleton-block-info",style:{maxWidth:"150px"},children:" "})]}),Object(B.jsxs)("div",{className:"comments-header",children:[Object(B.jsx)("div",{className:"comment-counter-wrapper",children:Object(B.jsxs)("span",{children:["Comments: ",null!==(t=a.descendants)&&void 0!==t?t:0]})}),Object(B.jsx)("button",{className:"button button-animated",onClick:f,children:Object(B.jsx)("span",{children:Object(B.jsxs)("span",{children:["Refresh ",m]})})})]}),Object(B.jsx)("section",{className:"comments-list",children:u.length>0?u.map((function(e){return Object(B.jsx)(I.a,{placeholder:Object(B.jsx)(E,{}),children:Object(B.jsx)(H,{commentID:e},e)},e)})):Object(B.jsx)("h3",{className:"h3",children:"No comments yet"})})]})})},U=function(){return Object(B.jsxs)("header",{children:[Object(B.jsx)("h1",{children:"HACKER NEWS"}),Object(B.jsxs)("nav",{className:"nav-center",children:[Object(B.jsx)(b.b,{to:"/",className:"nav-link",children:"STORIES"}),Object(B.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"nav-link",href:"https://github.com/Nistler/hacker-news-wrapper",children:"SOURCE CODE"})]})]})},J=function(){return Object(B.jsxs)("footer",{children:[Object(B.jsx)("h3",{className:"h3",children:"Hacker News API wrapper"}),Object(B.jsx)("div",{children:Object(B.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"link",href:"https://github.com/Nistler/hacker-news-wrapper/",children:"Build with React. You can see the description and source code in my repository."})})]})},P={addLatestStories:O,addStory:m,setBranchStatus:f},X=Object(d.b)((function(e){return{stories:e.stories}}),P)((function(e){var t=e.addLatestStories,n=e.addStory,c=e.setBranchStatus;Object(r.useEffect)((function(){(function(){var e=Object(j.a)(l.a.mark((function e(){var n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:n=e.sent,t({latestStoriesIDs:n.slice(0,100)}),s=JSON.parse(sessionStorage.getItem("branchesStatus")),c({commentBranch:null!==s&&void 0!==s?s:{}});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){}))}),[t,n,c]);var s=Object(B.jsxs)(u.c,{children:[Object(B.jsx)(u.a,{path:"/",exact:!0,component:R}),Object(B.jsx)(u.a,{path:"/:id",component:M})]});return Object(B.jsxs)(b.a,{basename:"/",children:[Object(B.jsx)(U,{}),s,Object(B.jsx)(J,{})]})})),G=n(78),V=n(79),Y=Object(V.a)((c={},Object(C.a)(c,O,(function(e,t){return{latestStoriesIDs:t.payload.latestStoriesIDs,stories:e.stories}})),Object(C.a)(c,m,(function(e,t){return{latestStoriesIDs:e.latestStoriesIDs,stories:t.payload.stories}})),c),{latestStoriesIDs:[],stories:[]}),z=Object(V.a)((s={},Object(C.a)(s,x,(function(e,t){return{commentBranch:e.commentBranch,loadingStatus:t.payload.loadingStatus}})),Object(C.a)(s,p,(function(e,t){var n=e.commentBranch,c=e.loadingStatus,s=t.payload,r=s.id,a=s.status;return{loadingStatus:c,commentBranch:Object(W.a)(Object(W.a)({},n),{},Object(C.a)({},r,a))}})),Object(C.a)(s,f,(function(e,t){return{loadingStatus:e.loadingStatus,commentBranch:t.payload.commentBranch}})),s),{loadingStatus:"loading",commentBranch:{}}),F=Object(G.a)({stories:Y,ui:z}),K=Object(G.b)(F,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());Object(i.render)(Object(B.jsx)(d.a,{store:K,children:Object(B.jsx)(a.a.StrictMode,{children:Object(B.jsx)(X,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.d829aab0.chunk.js.map