(this["webpackJsonphacker-news-wrapper"]=this["webpackJsonphacker-news-wrapper"]||[]).push([[0],{43:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var c,s,r=n(0),a=n.n(r),i=n(22),o=(n(43),n(4)),j=n.n(o),u=n(8),d=n(5),h=n(15),b=n(3),l=n(14),O=n(80),m=Object(O.a)("STORIES_LATEST_ADD"),f=Object(O.a)("STORY_ADD"),p=Object(O.a)("LOADING_STATUS_CHANGE"),x=Object(O.a)("BRANCH_STATUS_SET"),S=Object(O.a)("BRANCH_STATUS_CHANGE"),v=n(25),N=n.n(v),g="https://hacker-news.firebaseio.com/v0/",w=function(){var e=Object(u.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("".concat(g,"newstories.json?print=pretty")).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(e){return N.a.get("".concat(g,"item/").concat(e,".json?print=pretty")).then((function(e){return e.data})).catch((function(e){console.log(e)}))},k=n(1),B=function(){return Object(k.jsxs)("article",{className:"story-preview",children:[Object(k.jsx)(l.b,{className:"link",to:"/",children:"Title"}),Object(k.jsxs)("section",{className:"story-info",children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Score:"})," 0"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"By:"})," Anonymous"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Posted:"})," now"]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Comments:"})," 0"]})]})]})},E=function(e){var t=6e4,n=36e5,c=864e5,s=2592e6,r=31536e6,a=new Date-new Date(1e3*e);return a<t?Math.round(a/1e3)+" seconds ago":a<n?Math.round(a/t)+" minutes ago":a<c?Math.round(a/n)+" hours ago":a<s?Math.round(a/c)+" days ago":a<r?Math.round(a/s)+" months ago":Math.round(a/r)+" years ago"},T=function(e){var t=e.id,n=Object(r.useState)({}),c=Object(d.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)("fetching"),o=Object(d.a)(i,2),h=o[0],b=o[1];return Object(r.useEffect)((function(){b("fetching"),function(){var e=Object(u.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then((function(){return b("finished")}))}),[t]),s&&"fetching"!==h?Object(k.jsxs)("article",{className:"story-preview",children:[Object(k.jsx)(l.b,{className:"link",to:"/".concat(s.id),children:s.title}),Object(k.jsxs)("section",{className:"story-info",children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Score:"})," ",s.score]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"By:"})," ",s.by]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Posted:"})," ",E(s.time)]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Comments:"})," ",s.descendants]})]})]}):Object(k.jsx)(B,{})},D=n(19),I=n.n(D),_={addLatestStories:m},A=Object(h.b)((function(e){return{stories:e.stories,ui:e.ui}}),_)((function(e){var t=e.stories,n=e.addLatestStories,c=Object(r.useState)(59),s=Object(d.a)(c,2),a=s[0],i=s[1];Object(r.useEffect)((function(){var e;return a>0?e=setTimeout((function(){return i(a-1)}),1e3):o().then((function(){return i(59)})),function(){clearTimeout(e)}}),[i,a]);var o=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,n({latestStoriesIDs:t.slice(0,100)}),i(59);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(k.jsxs)("main",{children:[Object(k.jsx)("h2",{children:"LATEST STORIES"}),Object(k.jsx)("div",{className:"refresh-btn-wrapper",children:Object(k.jsx)("button",{className:"button button-animated",onClick:o,children:Object(k.jsx)("span",{children:Object(k.jsxs)("span",{children:["Refresh ",a]})})})}),Object(k.jsx)("section",{className:"stories-list",children:t.latestStoriesIDs.map((function(e){return Object(k.jsx)(I.a,{placeholder:Object(k.jsx)(B,{}),offset:300,children:Object(k.jsx)(T,{id:e},e)},e)}))})]})})),C=n(12),R=n(13),L={changeBranchStatus:S},H=Object(h.b)((function(e){return{ui:e.ui}}),L)((function e(t){var n=t.commentID,c=t.changeBranchStatus,s=t.ui,a=Object(r.useState)([]),i=Object(d.a)(a,2),o=i[0],h=i[1],b=Object(r.useState)({}),l=Object(d.a)(b,2),O=l[0],m=l[1],f=Object(r.useState)("finished"),p=Object(d.a)(f,2),x=p[0],S=p[1];Object(r.useEffect)((function(){(function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("fetching"),e.next=3,y(n);case 3:if(t=e.sent,m(t),t&&t.kids&&s.commentBranch[t.id]&&"closed"!==s.commentBranch[t.id]){e.next=7;break}return e.abrupt("return");case 7:h(t.kids);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){return S("finished")}))}),[n,s]);var v=!s.commentBranch[O.id]||"closed"===s.commentBranch[O.id];return O&&Object(k.jsxs)("article",{className:"comment",children:[Object(k.jsxs)("div",{className:"comment-info",children:[Object(k.jsx)("span",{children:"By: "}),O.by,Object(k.jsx)("span",{children:" Posted: "}),E(O.time)]}),O.deleted?Object(k.jsx)("h4",{children:"[commentary deleted]"}):Object(k.jsx)("div",{className:"comment-text",dangerouslySetInnerHTML:{__html:O.text}}),O.kids?Object(k.jsx)("button",{className:"button button-animated button-comment",onClick:function(){var e=s.commentBranch[O.id]&&"closed"!==s.commentBranch[O.id]?"closed":"opened";sessionStorage.setItem("branchesStatus",JSON.stringify(Object(R.a)(Object(R.a)({},s.commentBranch),{},Object(C.a)({},O.id,e)))),c({id:O.id,status:e})},disabled:"fetching"===x,children:Object(k.jsx)("span",{children:Object(k.jsx)("span",{children:v?"Show replies":"Hide replies"})})}):Object(k.jsx)("button",{className:"button btn-disabled",disabled:!0,children:"expand replies"}),function(){if(0!==O.kids&&0!==o.length&&s)return s.commentBranch[O.id]&&"opened"===s.commentBranch[O.id]?o.map((function(t){return Object(k.jsx)(I.a,{children:Object(k.jsx)(e,{commentID:t,changeBranchStatus:c,ui:s},t)},t)})):void 0}()]})})),M=function(e){var t=e.match.params.id,n=Object(r.useState)({}),c=Object(d.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)([]),o=Object(d.a)(i,2),h=o[0],b=o[1],l=Object(r.useState)("finished"),O=Object(d.a)(l,2),m=O[0],f=O[1],p=Object(r.useState)(59),x=Object(d.a)(p,2),S=x[0],v=x[1];Object(r.useEffect)((function(){var e;return S>0?e=setTimeout((function(){return v(S-1)}),1e3):N().then((function(){return v(59)})),function(){clearTimeout(e)}}),[v,S]),Object(r.useEffect)((function(){(function(){var e=Object(u.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f("fetching"),e.next=3,y(t);case 3:(n=e.sent).kids&&b(n.kids),a(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){return f("finished")}))}),[t,b]);var N=function(){var e=Object(u.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:(n=e.sent).kids&&b(n.kids),a(n),v(59);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s&&Object(k.jsx)("main",{children:"fetching"===m?Object(k.jsx)("h2",{children:"Loading"}):Object(k.jsxs)("article",{children:[Object(k.jsxs)("h2",{children:[s.title," (",Object(k.jsx)("a",{className:"nav-link link-source",href:s.url,children:"SOURCE"}),")"]}),Object(k.jsxs)("section",{className:"story-info justify-center",children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Score:"})," ",s.score]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"By:"})," ",s.by]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{children:"Posted:"})," ",E(s.time)]})]}),Object(k.jsxs)("div",{className:"comments-header",children:[Object(k.jsx)("div",{className:"comment-counter-wrapper",children:Object(k.jsxs)("span",{children:["Comments: ",s.descendants]})}),Object(k.jsx)("button",{className:"button button-animated",onClick:N,children:Object(k.jsx)("span",{children:Object(k.jsxs)("span",{children:["Refresh ",S]})})})]}),Object(k.jsx)("section",{className:"comments-list",children:h.length>0?h.map((function(e){return Object(k.jsx)(I.a,{placeholder:Object(k.jsx)(B,{}),children:Object(k.jsx)(H,{commentID:e},e)},e)})):Object(k.jsx)("h3",{className:"h3",children:"No comments yet"})})]})})},U=function(){return Object(k.jsxs)("header",{children:[Object(k.jsx)("h1",{children:"HACKER NEWS"}),Object(k.jsxs)("nav",{className:"nav-center",children:[Object(k.jsx)(l.b,{to:"/",className:"nav-link",children:"STORIES"}),Object(k.jsx)("a",{className:"nav-link",href:"https://github.com/Nistler/hacker-news-wrapper",children:"SOURCE CODE"})]})]})},P=function(){return Object(k.jsxs)("footer",{children:[Object(k.jsx)("h3",{className:"h3",children:"Hacker News API wrapper"}),Object(k.jsx)("div",{children:Object(k.jsx)("a",{className:"link",href:"https://github.com/Nistler/hacker-news-wrapper/",children:"Build with React. You can see the description and source code in my repository."})})]})},G={addLatestStories:m,addStory:f,setBranchStatus:x},J=Object(h.b)((function(e){return{stories:e.stories}}),G)((function(e){var t=e.addLatestStories,n=e.addStory,c=e.setBranchStatus,s=Object(r.useState)("fetching"),a=Object(d.a)(s,2),i=a[0],o=a[1];Object(r.useEffect)((function(){o("fetching"),function(){var e=Object(u.a)(j.a.mark((function e(){var n,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:n=e.sent,t({latestStoriesIDs:n.slice(0,100)}),s=JSON.parse(sessionStorage.getItem("branchesStatus")),c({commentBranch:null!==s&&void 0!==s?s:{}});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then((function(){return o("finished")}))}),[t,n,c]);var h=Object(k.jsxs)(b.c,{children:[Object(k.jsx)(b.a,{path:"/",exact:!0,component:A}),Object(k.jsx)(b.a,{path:"/:id",component:M})]});return Object(k.jsxs)(l.a,{basename:"/",children:[Object(k.jsx)(U,{}),"fetching"===i?Object(k.jsx)("main",{children:Object(k.jsx)("h2",{children:"LOADING"})}):h,Object(k.jsx)(P,{})]})})),X=n(78),V=n(79),Y=Object(V.a)((c={},Object(C.a)(c,m,(function(e,t){return{latestStoriesIDs:t.payload.latestStoriesIDs,stories:e.stories}})),Object(C.a)(c,f,(function(e,t){return{latestStoriesIDs:e.latestStoriesIDs,stories:t.payload.stories}})),c),{latestStoriesIDs:[],stories:[]}),K=Object(V.a)((s={},Object(C.a)(s,p,(function(e,t){return{commentBranch:e.commentBranch,loadingStatus:t.payload.loadingStatus}})),Object(C.a)(s,S,(function(e,t){var n=e.commentBranch,c=e.loadingStatus,s=t.payload,r=s.id,a=s.status;return{loadingStatus:c,commentBranch:Object(R.a)(Object(R.a)({},n),{},Object(C.a)({},r,a))}})),Object(C.a)(s,x,(function(e,t){return{loadingStatus:e.loadingStatus,commentBranch:t.payload.commentBranch}})),s),{loadingStatus:"loading",commentBranch:{}}),W=Object(X.a)({stories:Y,ui:K}),q=Object(X.b)(W,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());Object(i.render)(Object(k.jsx)(h.a,{store:q,children:Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(J,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.188ea2a3.chunk.js.map